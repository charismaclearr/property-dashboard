<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Property Dashboard</title>
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css" />
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    #addressInput { width: 300px; padding: 8px; font-size: 16px; }
    #vizContainer { margin-top: 30px; }
    iframe { width: 1000px; height: 827px; border: none; display: block; }
  </style>
</head>
<body>
  <h2>Enter an Address</h2>
  <input type="text" id="addressInput" placeholder="Start typing an address..." />
  <div id="vizContainer"></div>

  <!-- jQuery and jQuery UI -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>

  <script>
    // Load addresses for autocomplete
    fetch('https://charismaclearr.github.io/property-dashboard/addresses.json')
      .then(res => res.json())
      .then(addresses => {
        $('#addressInput').autocomplete({
          source: addresses,
          select: function(event, ui) {
            const selectedAddress = ui.item.value; // This should be the full address
            loadTableauDashboard(selectedAddress);
          }
        });
      })
      .catch(err => {
        console.error('Failed to load addresses.json:', err);
      });

    function loadTableauDashboard(address) {
      // URL encode parameter name and value
      const paramName = 'FullAddress%20Parameter';
      const paramValue = encodeURIComponent(address);
      const baseUrl = 'https://public.tableau.com/views/AddressDashboard_17479873620460/MapDashboard';
      const params = `?:embed=y&:showVizHome=no&${paramName}=${paramValue}`;
      const fullUrl = `${baseUrl}${params}`;

      // Render in an iframe (most robust for Tableau Public)
      document.getElementById('vizContainer').innerHTML =
        `<iframe src="${fullUrl}" allowfullscreen></iframe>`;
    }
  </script>
</body>
</html>
